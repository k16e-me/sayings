---
import Lipsum from './Lipsum.astro'
import Icon from 'astro-icon'
const { book = '' } = Astro.props
---
<button
	class='fixed left-3 bottom-20 md:bottom-28 lg:static text-slate-950 z-40'
	data-toggle-chapters>
	<div
		class='flex items-center justify-center text-center lg:space-x-5 w-14 h-14 lg:h-auto bg-slate-100 rounded-full lg:rounded-xl lg:w-full lg:p-5 shadow hover:shadow-xl transition duration-700 opacity-80 hover:opacity-100 pointer-events-none'>
		<Icon name='list' class='w-7' />
		<span class='sr-only lg:not-sr-only lg:font-display pointer-events-none'>Chapters</span>
	</div>
</button>
<div
	class='fixed inset-0 bg-slate-950 z-40 overflow-hidden transition duration-300 ease-linear !m-0 opacity-0 invisible'
	data-slideover>
</div>
<aside
	class='fixed inset-y-0 right-5 z-50 flex items-center justify-end !m-0 h-full opacity-0 translate-x-full transition duration-300 ease-in-out'
    data-chapters>
	<div
		class='bg-white sm:max-w-sm rounded-xl lg:rounded-2xl h-full max-h-[calc(100vh-96px)] flex flex-col shadow-xl overflow-hidden'>
		<div class='p-5 bg-slate-100'>
			<h2 class='font-display text-xl'>
				Chapters <span class='sr-only'>in { book }</span>
			</h2>
		</div>
		<div class='flex-1 overflow-auto p-3 sm:p-5'>
			<Lipsum />
		</div>
	</div>
</aside>

<script>
    const
        button = document.querySelector('[data-toggle-chapters]'),
        backdrop = document.querySelector('[data-slideover]'),
        chapters = document.querySelector('[data-chapters]'),
        translateIn = ['translate-x-0', 'opacity-100'],
        translateOut = ['translate-x-full', 'opacity-0'],
        hidden = ['invisible']

    button.addEventListener('click', () => {
        backdrop.classList.remove('opacity-0')
        backdrop.classList.add('opacity-60')
        backdrop.classList.remove(...hidden)
        chapters.classList.add(...translateIn)
        chapters.classList.remove(...translateOut)
    })

    backdrop.addEventListener('click', () => {
        backdrop.classList.add('opacity-0')
        backdrop.classList.remove('opacity-60')
        chapters.classList.remove(...translateIn)
        chapters.classList.add(...translateOut)
        setTimeout(() => {
            backdrop.classList.add(...hidden)
        }, 300)
    })
</script>